'use client'

import { UserButton } from '@/app/components/auth/user-button'
import { redirect, usePathname } from 'next/navigation'
import { isTeacher } from '@/lib/teacher'

import { Button } from '@/components/ui/button'
import { LogOut } from 'lucide-react'
import Link from 'next/link'
import SearchInput from './SearchInput'
import Logo from '@/app/(dashboard)/_components/Logo'
import { useCurrentUser } from '@/hooks/use-current-user'

const NavbarRoutes = () => {
  const pathname = usePathname()

  const user = useCurrentUser()
  if (!user) redirect('/auth/login')

  const isTeatcherPage = pathname?.startsWith('/teacher')
  const isStudentPage = pathname?.startsWith('/courses')
  const isSearchPage = pathname == '/courses'

  return (
    <div className='flex w-full items-center justify-between '>
      <div className='p-4 flex flex-1 lg:flex-initial items-center gap-3 justify-center '>
        <Logo />
        <svg
          width='95'
          height='17'
          viewBox='0 0 95 17'
          fill='none'
          xmlns='http://www.w3.org/2000/svg'
        >
          <path
            d='M6.3358 16.5567C6.09564 16.5567 5.85467 16.5454 5.61451 16.5211C3.46427 16.3079 1.70842 15.0874 0.670654 13.0842C0.461012 12.6788 0.617641 12.1788 1.02086 11.968C1.42408 11.7571 1.92128 11.9146 2.13092 12.3201C2.90282 13.8112 4.19762 14.7183 5.77596 14.875C7.33341 15.0276 8.95111 14.5212 9.80092 13.6117C10.3431 13.0309 10.5487 12.3072 10.4122 11.4607C10.1158 9.62715 8.28764 9.04559 6.80569 8.88001L6.52376 8.84931C5.75828 8.76692 4.96791 8.68211 4.18718 8.41233C2.03292 7.6676 0.798367 5.38334 1.43532 3.31878C2.14136 1.03209 4.77433 0.0490902 7.0073 0.258292C9.09247 0.453763 10.9463 1.69443 11.9672 3.57564C12.1849 3.97708 12.0379 4.47949 11.6387 4.69838C11.2395 4.91728 10.7399 4.76946 10.5222 4.36802C9.77522 2.99165 8.37037 2.04822 6.85469 1.90606C5.32374 1.76067 3.44981 2.37939 3.00804 3.80907C2.58635 5.17333 3.5703 6.44793 4.72293 6.84614C5.32776 7.05534 5.99443 7.12723 6.69967 7.20235L6.98802 7.23385C9.88365 7.55614 11.6773 8.96239 12.0379 11.1933C12.258 12.5544 11.8997 13.7813 11.0025 14.7433C9.94229 15.879 8.16636 16.5559 6.33821 16.5559L6.3358 16.5567ZM24.12 14.8855C25.2333 13.7215 25.8028 12.1626 25.6831 10.6094C25.455 7.66195 22.8196 5.33972 19.9344 5.53115C17.2155 5.7137 15.0074 8.04481 14.907 10.8379C14.7994 13.8298 17.1705 16.4541 20.0846 16.568C20.1489 16.5704 20.2131 16.572 20.2782 16.572C21.6975 16.572 23.0887 15.9638 24.1208 14.8855H24.12ZM16.552 10.8985C16.6227 8.9422 18.1569 7.31059 20.0445 7.18296C22.0477 7.05373 23.8831 8.67565 24.0421 10.7378C24.1256 11.8201 23.7216 12.9138 22.9337 13.7377C22.1802 14.5252 21.165 14.959 20.1481 14.9146C18.1231 14.8354 16.4765 12.9962 16.552 10.8985ZM32.4021 16.4791C32.8414 16.3604 33.1017 15.9065 32.9836 15.4654C32.8655 15.0236 32.4133 14.7619 31.9756 14.8806C31.9507 14.8871 31.3611 15.0406 30.8872 14.6698C30.7651 14.5745 30.6639 14.4558 30.586 14.3168C30.484 14.1351 30.4302 13.9049 30.4302 13.6513L30.4189 1.65728C30.4189 1.2001 30.0502 0.835817 29.5956 0.835817H29.5948C29.1402 0.835817 28.7723 1.21303 28.7723 1.6702L28.7835 13.6529C28.7835 14.1916 28.9113 14.7029 29.1522 15.131C29.337 15.4614 29.5812 15.7457 29.8759 15.9767C30.488 16.4557 31.149 16.572 31.647 16.572C32.0205 16.572 32.3017 16.5066 32.4021 16.4799V16.4791ZM44.1701 5.17818H44.1589C43.7091 5.17818 43.3412 5.53923 43.3356 5.99479L43.248 12.3532C43.2456 12.6182 43.1846 12.8775 43.0561 13.1061C42.4336 14.2264 41.2512 14.9404 39.9644 14.9404H39.9588C38.6721 14.9404 37.4897 14.2256 36.8672 13.1061C36.7379 12.8775 36.6776 12.6182 36.6752 12.3532L36.5877 5.99479C36.5821 5.53923 36.2142 5.17818 35.7644 5.17818H35.7531C35.2977 5.18383 34.9355 5.55862 34.9411 6.0166L35.0262 12.1432C35.0375 12.9679 35.2841 13.7789 35.7668 14.4437C36.7323 15.7708 38.2849 16.5954 39.9612 16.5954C41.6376 16.5954 43.1902 15.7708 44.1557 14.4437C44.6384 13.7789 44.885 12.9679 44.8963 12.1432L44.9814 6.0166C44.987 5.55862 44.6248 5.18383 44.1693 5.17818H44.1701ZM54.4346 16.5228C54.7639 16.5187 55.0595 16.3176 55.1856 16.0115L61.1881 1.40688C61.3616 0.98444 61.1616 0.500609 60.7415 0.326139C60.3222 0.151669 59.8403 0.351986 59.6668 0.775237L54.4008 13.5866L48.7879 0.758273C48.6047 0.339868 48.1188 0.149244 47.7035 0.334214C47.2875 0.518377 47.0987 1.00625 47.2818 1.42465L53.6723 16.0292C53.804 16.3297 54.0996 16.5236 54.4257 16.5236H54.4354L54.4346 16.5228ZM65.5753 15.7845V6.30738C65.5753 5.85021 65.2066 5.47946 64.752 5.47946C64.2974 5.47946 63.9287 5.85021 63.9287 6.30738V15.7845C63.9287 16.2417 64.2974 16.6124 64.752 16.6124C65.2066 16.6124 65.5753 16.2417 65.5753 15.7845ZM77.7225 15.4218C78.0944 15.1585 78.1843 14.6424 77.9225 14.2692C77.6606 13.8952 77.1482 13.8055 76.7763 14.0681C75.1546 15.2142 73.0276 15.1585 71.72 13.9356C70.5979 12.8863 70.4268 11.2846 70.7561 10.1627C71.0621 9.1191 71.8629 8.17647 72.8983 7.64095C73.8092 7.17004 74.7859 7.07715 75.6477 7.37843C76.8261 7.79118 77.7136 8.89374 78.0181 10.2483H74.659C74.2043 10.2483 73.8357 10.6191 73.8357 11.0762C73.8357 11.5334 74.2043 11.9042 74.659 11.9042H78.9514C79.1747 11.9042 79.3892 11.8129 79.5442 11.6505C79.6992 11.4882 79.782 11.2701 79.7739 11.0455C79.6832 8.63688 78.2422 6.53517 76.1883 5.81629C74.8975 5.36476 73.4614 5.48996 72.1457 6.17007C70.7175 6.90833 69.6075 8.22655 69.177 9.69581C68.601 11.6618 69.1593 13.8023 70.5987 15.1488C71.5899 16.0761 72.8959 16.5446 74.2397 16.5446C75.4349 16.5446 76.6606 16.173 77.7217 15.4234L77.7225 15.4218ZM91.211 16.0672L94.2609 6.47701C94.399 6.04164 94.1605 5.57558 93.7275 5.43665C93.2954 5.29691 92.8311 5.53762 92.693 5.97299L90.4319 13.0826L88.3074 6.31627C88.2006 5.97622 87.8897 5.74359 87.5347 5.73793H87.5226C87.1732 5.73793 86.8616 5.96006 86.7459 6.29284L84.3194 13.2797L81.6655 5.80094C81.5129 5.37042 81.0414 5.14587 80.6141 5.29934C80.186 5.45281 79.9627 5.92614 80.1153 6.35666L83.5523 16.0438C83.6687 16.3733 83.9796 16.593 84.3274 16.593H84.3298C84.6792 16.5922 84.9893 16.3693 85.1041 16.0381L87.4833 9.18775L89.6423 16.0632C89.75 16.4072 90.0672 16.6407 90.4255 16.6415H90.4271C90.7853 16.6415 91.1018 16.4089 91.211 16.0664V16.0672ZM64.7359 0.822895C64.0484 0.822895 63.4893 1.38588 63.4893 2.07649C63.4893 2.7671 64.0484 3.3309 64.7359 3.3309C65.4235 3.3309 65.9825 2.76791 65.9825 2.07649C65.9825 1.38507 65.4235 0.822895 64.7359 0.822895Z'
            fill='url(#paint0_linear_1606_477)'
          />
          <defs>
            <linearGradient
              id='paint0_linear_1606_477'
              x1='0.577479'
              y1='8.43656'
              x2='94.2994'
              y2='8.43656'
              gradientUnits='userSpaceOnUse'
            >
              <stop stop-color='#200090' />
              <stop offset='0.86' stop-color='#5F57E7' />
            </linearGradient>
          </defs>
        </svg>
      </div>
      {isSearchPage && (
        <div className='hidden lg:block'>
          <SearchInput />
        </div>
      )}
      <div className='flex gap-x-2 '>
        {isTeatcherPage || isStudentPage ? (
          <Link href='/'>
            <Button size='sm' variant='ghost'>
              <LogOut />
              Exit
            </Button>
          </Link>
        ) : isTeacher(user!.userId) ? (
          <Link href='/teacher/courses'>
            <Button size='sm' variant='ghost'>
              Teacher
            </Button>
          </Link>
        ) : null}
        <UserButton />
      </div>
    </div>
  )
}

export default NavbarRoutes
